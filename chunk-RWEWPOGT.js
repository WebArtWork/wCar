import{e as M}from"./chunk-LGAQXJCQ.js";import{I as o,L as p,M as u,Pa as w,R as _,Ra as C,Va as y,X as v,ab as g,f as n,fb as b,gb as S,i as c,mb as I,r as h,s as f,tb as j,vb as k}from"./chunk-XY7HJDFI.js";var R={formId:"cartrade",title:"Cartrade",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill cartrade title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill cartrade description"},{name:"Label",value:"Description"}]}]};var F=(()=>{class i extends S{constructor(){super({name:"cartrade"})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var m=(()=>{class i{constructor(e,t,r,s,l,P,T){this._translate=e,this._cartradeService=t,this._alert=r,this._route=s,this._form=l,this._core=P,this._router=T,this.columns=["name","description"],this.form=this._form.getForm("cartrade",R),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._cartradeService.setPerPage.bind(this._cartradeService),allDocs:!1,create:this._router.url.includes("cartrade/")?()=>{this._form.modal(this.form,{label:"Create",click:(a,d)=>n(this,null,function*(){d(),this._preCreate(a),yield c(this._cartradeService.create(a)),this.setRows()})})}:null,update:a=>{this._form.modal(this.form,[],a).then(d=>{this._core.copy(d,a),this._cartradeService.update(a)})},delete:a=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this cartrade?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>n(this,null,function*(){yield c(this._cartradeService.delete(a)),this.setRows()})}]})},buttons:[{icon:"cloud_download",click:a=>{this._form.modalUnique("cartrade","url",a)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this.car_id="",this._page=1,this.setRows(),this._route.paramMap.subscribe(a=>{this.car_id=a.get("car_id")||""})}setRows(e=this._page){this._page=e,this._core.afterWhile(this,()=>{this._cartradeService.get({page:e,query:this._query()}).subscribe(t=>{this.rows.splice(0,this.rows.length),this.rows.push(...t)})},250)}_bulkManagement(e=!0){return()=>{this._form.modalDocs(e?[]:this.rows).then(t=>n(this,null,function*(){if(e)for(let r of t)this._preCreate(r),yield c(this._cartradeService.create(r));else{for(let r of this.rows)t.find(s=>s._id===r._id)||(yield c(this._cartradeService.delete(r)));for(let r of t){let s=this.rows.find(l=>l._id===r._id);s?(this._core.copy(r,s),yield c(this._cartradeService.update(s))):(this._preCreate(r),yield c(this._cartradeService.create(r)))}}this.setRows()}))}}_preCreate(e){e.__created=!1,this.car_id&&(e.car=this.car_id)}_query(){let e="";return this.car_id&&(e+=(e?"&":"")+"car="+this.car_id),e}static{this.\u0275fac=function(t){return new(t||i)(o(I),o(F),o(b),o(w),o(k),o(g),o(C))}}static{this.\u0275cmp=p({type:i,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Trade",3,"columns","config","rows"]],template:function(t,r){t&1&&v(0,"wtable",0),t&2&&_("columns",r.columns)("config",r.config)("rows",r.rows)},dependencies:[j],encapsulation:2})}}return i})();var D=[{path:"",component:m},{path:":car_id",component:m}],O=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=u({type:i})}static{this.\u0275inj=f({imports:[y.forChild(D),M]})}}return i})();export{O as CartradeModule};
